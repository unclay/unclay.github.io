<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>Eleven</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
  <body>
    <container class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">Eleven</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">首页</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives/" class="menu-item-link">归档</a>
        </li>
      
        <li class="menu-item">
          <a href="https://github.com/unclay" class="menu-item-link">Github</a>
        </li>
      
    </ul>
  </nav>
</header>
      <main class="main">
        <article class="post">
  <div class="post-title">
    <h2 class="title">Ubuntu16.04安装最新版nodejs</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2017-05-13</span>
  </div>
  <div class="post-content markdown-body">
    <p>最近公司服务器因为某些原因，导致服务器环境需要全部重新部署，安装nodejs又忘了，记录下，方便下次使用。<br><a id="more"></a></p>
<h1 id="安装最新版nodejs"><a href="#安装最新版nodejs" class="headerlink" title="安装最新版nodejs"></a>安装最新版nodejs</h1><h5 id="更新ubuntu软件源"><a href="#更新ubuntu软件源" class="headerlink" title="更新ubuntu软件源"></a>更新ubuntu软件源</h5><pre><code>sudo apt-get update
sudo apt-get install -y python-software-properties software-properties-common
sudo add-apt-repository ppa:chris-lea/node.js
sudo apt-get update
</code></pre><h5 id="安装nodejs"><a href="#安装nodejs" class="headerlink" title="安装nodejs"></a>安装nodejs</h5><pre><code>sudo apt-get install nodejs
sudo apt install nodejs-legacy
sudo apt install npm
</code></pre><h5 id="更新npm的包镜像源，方便快速下载"><a href="#更新npm的包镜像源，方便快速下载" class="headerlink" title="更新npm的包镜像源，方便快速下载"></a>更新npm的包镜像源，方便快速下载</h5><pre><code>sudo npm config set registry https://registry.npm.taobao.org
sudo npm config list
</code></pre><h5 id="全局安装n管理器-用于管理nodejs版本"><a href="#全局安装n管理器-用于管理nodejs版本" class="headerlink" title="全局安装n管理器(用于管理nodejs版本)"></a>全局安装n管理器(用于管理nodejs版本)</h5><pre><code>sudo npm install n -g
</code></pre><h5 id="安装最新的nodejs（stable版本）"><a href="#安装最新的nodejs（stable版本）" class="headerlink" title="安装最新的nodejs（stable版本）"></a>安装最新的nodejs（stable版本）</h5><pre><code>sudo n stable
sudo node -v
</code></pre><h1 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h1><h4 id="Q-apt-get-update找不到文件"><a href="#Q-apt-get-update找不到文件" class="headerlink" title="Q: apt-get update找不到文件"></a>Q: apt-get update找不到文件</h4><pre><code>// error code
W: The repository &apos;http://ppa.launchpad.net/chris-lea/node.js/ubuntu xenial Release&apos; does not have a Release file.
N: Data from such a repository can&apos;t be authenticated and is therefore potentially dangerous to use.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: Failed to fetch http://ppa.launchpad.net/chris-lea/node.js/ubuntu/dists/xenial/main/binary-amd64/Packages  404  Not Found
E: Some index files failed to download. They have been ignored, or old ones used instead.

// A: 修改node相关文件：/etc/apt/sources.list.d/chris-lea-ubuntu-node_js-xenial.list
deb http://ppa.launchpad.net/chris-lea/node.js/ubuntu trusty main
deb-src http://ppa.launchpad.net/chris-lea/node.js/ubuntu trusty main
</code></pre><h4 id="Q-node-v异常"><a href="#Q-node-v异常" class="headerlink" title="Q: node -v异常"></a>Q: node -v异常</h4><pre><code>node -v
-bash: /usr/local/bin/node: Permission denied

sudo node -v
Segmentation fault (core dumped)

// A: 重新安装nodejs
手动移除 /usr/local/lib/node_modules整个目录
手动移除 /usr/local/bin/node
手动移除 /usr/local/bin/n
手动移除 /usr/local/bin/npm
</code></pre><h1 id="ubuntu软件源"><a href="#ubuntu软件源" class="headerlink" title="ubuntu软件源"></a>ubuntu软件源</h1><p>修改/etc/apt/sources.list为以下软件源（改前请备份）<br>163和里面在部分网络下会一直下载失败，可以改回官方源下载</p>
<h5 id="源列表"><a href="#源列表" class="headerlink" title="源列表"></a>源列表</h5><p><a href="http://wiki.ubuntu.org.cn/模板:16.04source" target="_blank" rel="noopener">http://wiki.ubuntu.org.cn/模板:16.04source</a></p>
<h5 id="Ubuntu官方"><a href="#Ubuntu官方" class="headerlink" title="Ubuntu官方"></a>Ubuntu官方</h5><pre><code>deb http://cn.archive.ubuntu.com/ubuntu/ xenial main restricted universe multiverse
deb http://cn.archive.ubuntu.com/ubuntu/ xenial-security main restricted universe multiverse
deb http://cn.archive.ubuntu.com/ubuntu/ xenial-updates main restricted universe multiverse
deb http://cn.archive.ubuntu.com/ubuntu/ xenial-backports main restricted universe multiverse
deb http://cn.archive.ubuntu.com/ubuntu/ xenial-proposed main restricted universe multiverse
deb-src http://cn.archive.ubuntu.com/ubuntu/ xenial main restricted universe multiverse
deb-src http://cn.archive.ubuntu.com/ubuntu/ xenial-security main restricted universe multiverse
deb-src http://cn.archive.ubuntu.com/ubuntu/ xenial-updates main restricted universe multiverse
deb-src http://cn.archive.ubuntu.com/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://cn.archive.ubuntu.com/ubuntu/ xenial-proposed main restricted universe multiverse
</code></pre>
  </div>
</article>
      </main>
      <div class="footer">
  Copyright © 2017
     - 2018
   Clay | 
  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> | Theme by <a href="https://github.com/unclay/hexo-theme-eleven">Eleven</a>.
</div>

    </container>
  </body>
</html>